

### 秒杀设计方案？

风隔预灰，C负资，状限lua开，异分unsigned，压测。

风控隔离预热置灰
CDN负载均衡资格无效
无状态限流lua队列开关
异步分库UNSIGNED

老婆风控股票，要求在资金隔离，购买些股票预热，后将买卖股票按钮置灰。
资金通过CDN做负载均衡，判断购买股票资格无效
软件开启了无状态限流，打开lua队列开关，只能排队买股票
买完后结果都是异步的，在分库UNSIGNED中查询。

设计的时候会用到一些设计模式吗？有这样比较好的设计案例吗？

设计模式三类，以及应用，参数源码应用。
创建型模式（原工单抽建/建造单例工厂，抽象工厂原型）
结构型模式（享代装适组外桥/享元装饰外观，代理桥接适配组合）
行为型模式 （中访观模状解策命责迭备）【策略模式、模板方法模式、观察者模式、迭代子模式、责任链模式、命令模式、备忘录模式、状态模式、访问者模式、中介者模式、解释器模式。】

#### 红包

100块钱10个红包，红包大小6~12元之间。
随机，额度在0.01和(剩余平均值*2)之间。
例如：发100块钱，总共10个红包，那么平均值是10块钱一个，那么发出来的红包的额度在0.01元～20元之间波动。
当前面3个红包总共被领了40块钱时，剩下60块钱，总共7个红包，那么这7个红包的额度在：0.01～（60/7 *2）=17.14之间。
注意：这里的算法是每被抢一个后，剩下的会再次执行上面的这样的算法
这样算下去，会超过最开始的全部金额，因此到了最后面如果不够这么算，那么会采取如下算法：保证剩余用户能拿到最低1分钱即可。
如果前面的人手气不好，那么后面的余额越多，红包额度也就越多，因此实际概率一样的。




#### 在现场跑了一段程序，跑了一段时间后慢了下来，你会从哪些方面和使用哪些手段去诊断这个问题？